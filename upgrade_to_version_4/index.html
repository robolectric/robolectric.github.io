
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="test-drive your Android code">
      
      
      
        <link rel="canonical" href="https://robolectric.org/upgrade_to_version_4/">
      
      
        <link rel="prev" href="../automated-migration/">
      
      
        <link rel="next" href="../upgrade_to_version_3/">
      
      
      <link rel="icon" href="../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Upgrade to Robolectric 4.x - Robolectric</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","UA-19269905-2"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","UA-19269905-2",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=UA-19269905-2",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#migrating-to-416" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Robolectric" class="md-header__button md-logo" aria-label="Robolectric" data-md-component="logo">
      
  <img src="../images/robolectric-stacked.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Robolectric
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Upgrade to Robolectric 4.x
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/robolectric/robolectric" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    Robolectric
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../getting-started/" class="md-tabs__link">
          
  
  
    
  
  Setup

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../androidx_test/" class="md-tabs__link">
          
  
  
    
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../build-system-integration/" class="md-tabs__link">
          
  
  
    
  
  Customizing

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../building-robolectric/" class="md-tabs__link">
          
  
  
    
  
  Contributing

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../automated-migration/" class="md-tabs__link">
          
  
  
    
  
  Resources

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../blog/" class="md-tabs__link">
          
  
  
    
  
  Blog

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Robolectric" class="md-nav__button md-logo" aria-label="Robolectric" data-md-component="logo">
      
  <img src="../images/robolectric-stacked.png" alt="logo">

    </a>
    Robolectric
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/robolectric/robolectric" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    Robolectric
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Setup
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Setup
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../writing-a-test/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Writing Your First Test
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../androidx_test/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AndroidX Test
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuring/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuring Robolectric
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../device-configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Device Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../using-qualifiers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using Qualified Resources
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../using-add-on-modules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using Add-On Modules
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../best-practices/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Best Practices & Limitations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../simulator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Simulator
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Customizing
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Customizing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../build-system-integration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Build System Integration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../custom-test-runner/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Customizing the Test Runner
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Contributing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../building-robolectric/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Building Robolectric
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Robolectric Architecture
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributor Guidelines
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../extending/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Shadows
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Resources
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../automated-migration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Automated Migration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Upgrade to Robolectric 4.x
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Upgrade to Robolectric 4.x
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#migrating-to-416" class="md-nav__link">
    <span class="md-ellipsis">
      Migrating to 4.16
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Migrating to 4.16">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#breaking-changes" class="md-nav__link">
    <span class="md-ellipsis">
      Breaking Changes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deprecations" class="md-nav__link">
    <span class="md-ellipsis">
      Deprecations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removals" class="md-nav__link">
    <span class="md-ellipsis">
      Removals
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#migrating-to-415" class="md-nav__link">
    <span class="md-ellipsis">
      Migrating to 4.15
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Migrating to 4.15">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deprecations_1" class="md-nav__link">
    <span class="md-ellipsis">
      Deprecations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removals_1" class="md-nav__link">
    <span class="md-ellipsis">
      Removals
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-changes" class="md-nav__link">
    <span class="md-ellipsis">
      Other Changes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#migrating-to-414" class="md-nav__link">
    <span class="md-ellipsis">
      Migrating to 4.14
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Migrating to 4.14">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deprecations_2" class="md-nav__link">
    <span class="md-ellipsis">
      Deprecations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removals_2" class="md-nav__link">
    <span class="md-ellipsis">
      Removals
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#migrating-to-413" class="md-nav__link">
    <span class="md-ellipsis">
      Migrating to 4.13
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Migrating to 4.13">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#breaking-changes_1" class="md-nav__link">
    <span class="md-ellipsis">
      Breaking Changes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deprecations_3" class="md-nav__link">
    <span class="md-ellipsis">
      Deprecations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removals_3" class="md-nav__link">
    <span class="md-ellipsis">
      Removals
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#migrating-to-412" class="md-nav__link">
    <span class="md-ellipsis">
      Migrating to 4.12
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Migrating to 4.12">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deprecations_4" class="md-nav__link">
    <span class="md-ellipsis">
      Deprecations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removals_4" class="md-nav__link">
    <span class="md-ellipsis">
      Removals
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#migrating-to-411" class="md-nav__link">
    <span class="md-ellipsis">
      Migrating to 4.11
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Migrating to 4.11">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#breaking-changes_2" class="md-nav__link">
    <span class="md-ellipsis">
      Breaking Changes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deprecations_5" class="md-nav__link">
    <span class="md-ellipsis">
      Deprecations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#migrating-to-410" class="md-nav__link">
    <span class="md-ellipsis">
      Migrating to 4.10
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Migrating to 4.10">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#removals_5" class="md-nav__link">
    <span class="md-ellipsis">
      Removals
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#migrating-to-49" class="md-nav__link">
    <span class="md-ellipsis">
      Migrating to 4.9
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Migrating to 4.9">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deprecations_6" class="md-nav__link">
    <span class="md-ellipsis">
      Deprecations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removals_6" class="md-nav__link">
    <span class="md-ellipsis">
      Removals
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#migrating-to-40" class="md-nav__link">
    <span class="md-ellipsis">
      Migrating to 4.0
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Migrating to 4.0">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Project Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deprecations_7" class="md-nav__link">
    <span class="md-ellipsis">
      Deprecations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#improper-use-of-shadows" class="md-nav__link">
    <span class="md-ellipsis">
      Improper Use of Shadows
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androidxtest" class="md-nav__link">
    <span class="md-ellipsis">
      androidx.test
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../upgrade_to_version_3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Upgrade to Robolectric 3.x
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4" >
        
          
          <label class="md-nav__link" for="__nav_6_4" id="__nav_6_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Javadoc
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4">
            <span class="md-nav__icon md-icon"></span>
            Javadoc
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="/javadoc/4.16/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.16
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="/javadoc/4.15/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.15
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="/javadoc/4.14/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.14
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="/javadoc/4.13/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.13
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="/javadoc/4.12/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.12
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="/javadoc/4.11/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.11
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="/javadoc/4.10/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.10
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="/javadoc/4.9/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.9
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="/javadoc/4.8/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.8
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="/javadoc/4.7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.7
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="/javadoc/4.6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.6
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="/javadoc/4.5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.5
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="/javadoc/4.4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.4
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="/javadoc/4.3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="/javadoc/4.2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="/javadoc/4.1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="/javadoc/4.0/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4.0
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_5" >
        
          
          <label class="md-nav__link" for="__nav_6_5" id="__nav_6_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_5">
            <span class="md-nav__icon md-icon"></span>
            
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/robolectric/robolectric/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GitHub
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/robolectric/robolectric/releases/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Releases
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/robolectric/robolectric/issues/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Issues
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../blog/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7" id="__nav_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Archive
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            Archive
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../blog/archive/2024/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2024
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../blog/archive/2023/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2023
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../blog/archive/2022/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2022
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../blog/archive/2021/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2021
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../blog/archive/2019/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2019
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../blog/archive/2018/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2018
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../blog/archive/2017/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2017
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#migrating-to-416" class="md-nav__link">
    <span class="md-ellipsis">
      Migrating to 4.16
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Migrating to 4.16">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#breaking-changes" class="md-nav__link">
    <span class="md-ellipsis">
      Breaking Changes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deprecations" class="md-nav__link">
    <span class="md-ellipsis">
      Deprecations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removals" class="md-nav__link">
    <span class="md-ellipsis">
      Removals
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#migrating-to-415" class="md-nav__link">
    <span class="md-ellipsis">
      Migrating to 4.15
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Migrating to 4.15">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deprecations_1" class="md-nav__link">
    <span class="md-ellipsis">
      Deprecations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removals_1" class="md-nav__link">
    <span class="md-ellipsis">
      Removals
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-changes" class="md-nav__link">
    <span class="md-ellipsis">
      Other Changes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#migrating-to-414" class="md-nav__link">
    <span class="md-ellipsis">
      Migrating to 4.14
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Migrating to 4.14">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deprecations_2" class="md-nav__link">
    <span class="md-ellipsis">
      Deprecations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removals_2" class="md-nav__link">
    <span class="md-ellipsis">
      Removals
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#migrating-to-413" class="md-nav__link">
    <span class="md-ellipsis">
      Migrating to 4.13
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Migrating to 4.13">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#breaking-changes_1" class="md-nav__link">
    <span class="md-ellipsis">
      Breaking Changes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deprecations_3" class="md-nav__link">
    <span class="md-ellipsis">
      Deprecations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removals_3" class="md-nav__link">
    <span class="md-ellipsis">
      Removals
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#migrating-to-412" class="md-nav__link">
    <span class="md-ellipsis">
      Migrating to 4.12
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Migrating to 4.12">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deprecations_4" class="md-nav__link">
    <span class="md-ellipsis">
      Deprecations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removals_4" class="md-nav__link">
    <span class="md-ellipsis">
      Removals
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#migrating-to-411" class="md-nav__link">
    <span class="md-ellipsis">
      Migrating to 4.11
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Migrating to 4.11">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#breaking-changes_2" class="md-nav__link">
    <span class="md-ellipsis">
      Breaking Changes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deprecations_5" class="md-nav__link">
    <span class="md-ellipsis">
      Deprecations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#migrating-to-410" class="md-nav__link">
    <span class="md-ellipsis">
      Migrating to 4.10
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Migrating to 4.10">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#removals_5" class="md-nav__link">
    <span class="md-ellipsis">
      Removals
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#migrating-to-49" class="md-nav__link">
    <span class="md-ellipsis">
      Migrating to 4.9
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Migrating to 4.9">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deprecations_6" class="md-nav__link">
    <span class="md-ellipsis">
      Deprecations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removals_6" class="md-nav__link">
    <span class="md-ellipsis">
      Removals
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#migrating-to-40" class="md-nav__link">
    <span class="md-ellipsis">
      Migrating to 4.0
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Migrating to 4.0">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Project Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deprecations_7" class="md-nav__link">
    <span class="md-ellipsis">
      Deprecations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#improper-use-of-shadows" class="md-nav__link">
    <span class="md-ellipsis">
      Improper Use of Shadows
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#androidxtest" class="md-nav__link">
    <span class="md-ellipsis">
      androidx.test
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  
    
      
    
    <a href="https://github.com/robolectric/robolectric.github.io/tree/main/docs/upgrade_to_version_4.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


  <h1>Upgrade to Robolectric 4.x</h1>

<!-- markdownlint-disable MD024 MD041 -->
<h2 id="migrating-to-416">Migrating to 4.16</h2>
<h3 id="breaking-changes">Breaking Changes</h3>
<ul>
<li>Drop support for API 21 and 22. Robolectric now supports API 23 (M) up to 36 (Baklava).</li>
</ul>
<h3 id="deprecations">Deprecations</h3>
<table>
<thead>
<tr>
<th>Deprecated symbol</th>
<th>Replacement</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>TextLayoutMode</code></td>
<td><code>TextLayoutMode.Mode.REALISTIC</code> is the default, and usages of these APIs can be removed.</td>
</tr>
<tr>
<td><code>TextLayoutModeConfigurer</code></td>
<td><code>TextLayoutMode.Mode.REALISTIC</code> is the default, and usages of these APIs can be removed.</td>
</tr>
</tbody>
</table>
<h3 id="removals">Removals</h3>
<table>
<thead>
<tr>
<th>Removed symbol</th>
<th>Replacement</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org.robolectric:shadows-playservices</code></td>
<td>Use APIs provided by Google Play Services libraries</td>
</tr>
<tr>
<td><code>FakeHttp#addPendingHttpResponseWithContentType(int, String, Header)</code></td>
<td><code>FakeHttp.getFakeHttpLayer().addPendingHttpResponse(statusCode, responseBody, contentType)</code></td>
</tr>
<tr>
<td><code>ShadowDefaultRequestDirector#getSentHttpRequest(int)</code></td>
<td><code>FakeHttp.getFakeHttpLayer().getSentHttpRequestInfo(index).getHttpRequest()</code></td>
</tr>
<tr>
<td><code>ShadowDefaultRequestDirector#getSentHttpRequestInfo(int)</code></td>
<td><code>FakeHttp.getFakeHttpLayer().getSentHttpRequestInfo(index)</code></td>
</tr>
</tbody>
</table>
<h2 id="migrating-to-415">Migrating to 4.15</h2>
<h3 id="deprecations_1">Deprecations</h3>
<table>
<thead>
<tr>
<th>Deprecated symbol</th>
<th>Replacement</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org.robolectric:shadows-playservices</code></td>
<td>Use APIs provided by Google Play Services libraries</td>
</tr>
<tr>
<td><code>ActivityController#configurationChange(Configuration, DisplayMetrics, int)</code></td>
<td><code>ActivityController#configurationChange(Configuration, DisplayMetrics)</code></td>
</tr>
<tr>
<td><code>AttributeSetBuilder</code></td>
<td><code>Xml#asAttributeSet()</code></td>
</tr>
<tr>
<td><code>Config.Builder#setAssetDir()</code></td>
<td>See <a href="https://robolectric.org/build-system-integration">build system integration</a></td>
</tr>
<tr>
<td><code>Config.Builder#setLibraries()</code></td>
<td>See <a href="https://robolectric.org/build-system-integration">build system integration</a></td>
</tr>
<tr>
<td><code>Config.Builder#setPackageName()</code></td>
<td>See <a href="https://robolectric.org/build-system-integration">build system integration</a></td>
</tr>
<tr>
<td><code>Config.Builder#setResourceDir()</code></td>
<td>See <a href="https://robolectric.org/build-system-integration">build system integration</a></td>
</tr>
<tr>
<td><code>Robolectric#buildAttributeSet()</code></td>
<td><code>Robolectric#getAttributeSetFromXml()</code></td>
</tr>
<tr>
<td><code>Robolectric#flushBackgroundThreadScheduler()</code></td>
<td><code>ShadowLooper#runToEndOfTasks()</code></td>
</tr>
<tr>
<td><code>Robolectric#flushForegroundThreadScheduler()</code></td>
<td><code>ShadowLooper#runToEndOfTasks()</code></td>
</tr>
<tr>
<td><code>Robolectric#getBackgroundThreadScheduler()</code></td>
<td>This is only needed in the <code>LEGACY</code> looper mode. We strongly encourage you to use the <code>PAUSED</code> looper mode (which is the default)</td>
</tr>
<tr>
<td><code>Robolectric#getForegroundThreadScheduler()</code></td>
<td>This is only needed in the <code>LEGACY</code> looper mode. We strongly encourage you to use the <code>PAUSED</code> looper mode (which is the default)</td>
</tr>
<tr>
<td><code>RuntimeEnvironment#getMasterScheduler()</code></td>
<td>This is only needed in the <code>LEGACY</code> looper mode. We strongly encourage you to use the <code>PAUSED</code> looper mode (which is the default)</td>
</tr>
<tr>
<td><code>RuntimeEnvironment#setMasterScheduler()</code></td>
<td>This is only needed in the <code>LEGACY</code> looper mode. We strongly encourage you to use the <code>PAUSED</code> looper mode (which is the default)</td>
</tr>
<tr>
<td><code>ShadowApplication#runBackgroundTasks()</code></td>
<td>This is only needed in the <code>LEGACY</code> looper mode. We strongly encourage you to use the <code>PAUSED</code> looper mode (which is the default)</td>
</tr>
<tr>
<td><code>ShadowAssetInputStream#isNinePatch()</code></td>
<td>Only use this in <code>LEGACY</code> graphics mode</td>
</tr>
<tr>
<td><code>ShadowRoleManager#addHeldRole()</code></td>
<td><code>ShadowRoleManager#addRoleHolder()</code></td>
</tr>
<tr>
<td><code>ShadowRoleManager#addAvailableRole()</code></td>
<td><code>ShadowRoleManager#addRoleHolder()</code></td>
</tr>
<tr>
<td><code>ShadowRoleManager#removeAvailableRole()</code></td>
<td><code>ShadowRoleManager#removeRoleHolder()</code></td>
</tr>
<tr>
<td><code>ShadowRoleManager#removeHeldRole()</code></td>
<td><code>ShadowRoleManager#removeRoleHolder()</code></td>
</tr>
</tbody>
</table>
<h3 id="removals_1">Removals</h3>
<table>
<thead>
<tr>
<th>Removed symbol</th>
<th>Replacement</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org.robolectric:shadows-multidex</code></td>
<td>No longer needed with min SDK being 21+</td>
</tr>
<tr>
<td><code>AndroidManifest#supportsBinaryResourcesMode()</code></td>
<td>N/A (it always returned <code>true</code>)</td>
</tr>
<tr>
<td><code>AndroidManifest#supportsLegacyResourcesMode()</code></td>
<td>N/A (it always returned <code>false</code>)</td>
</tr>
<tr>
<td><code>ConfigMerger</code></td>
<td><code>Provider&lt;Config&gt;</code></td>
</tr>
<tr>
<td><code>DependencyResolver#getLocalArtifactUrls()</code></td>
<td>N/A (overriding <code>getLocalArtifactUrl()</code> is enough)</td>
</tr>
<tr>
<td><code>Fs#fileFromPath(path)</code></td>
<td><code>Fs.fromUrl(path)</code></td>
</tr>
<tr>
<td><code>Fs#newFile(file)</code></td>
<td><code>file.toPath()</code></td>
</tr>
<tr>
<td><code>FsFile</code></td>
<td><code>Path</code></td>
</tr>
<tr>
<td><code>FsFile#getPath()</code></td>
<td><code>Fs.externalize(path)</code></td>
</tr>
<tr>
<td><code>FsFile#join(name)</code></td>
<td><code>path.resolve(name)</code></td>
</tr>
<tr>
<td><code>InvokeDynamicClassInstrumentor</code></td>
<td><code>ClassInstrumentor</code></td>
</tr>
<tr>
<td><code>IShadow#directlyOn(T, Class&lt;T&gt;)</code></td>
<td>Use a combination of <code>Reflector</code> and <code>Direct</code></td>
</tr>
<tr>
<td><code>MavenManifestFactory</code></td>
<td>See <a href="https://robolectric.org/build-system-integration">build system integration</a></td>
</tr>
<tr>
<td><code>PackageItemData#getClassName()</code></td>
<td><code>PackageItemData#getName()</code></td>
</tr>
<tr>
<td><code>ProxyMaker</code></td>
<td>Use a combination of <code>Reflector</code> and <code>Direct</code></td>
</tr>
<tr>
<td><code>Qualifiers#addScreenWidth()</code></td>
<td><code>Configuration#screenWidthDp</code></td>
</tr>
<tr>
<td><code>Qualifiers#addSmallestScreenWidth()</code></td>
<td><code>Configuration#smallestScreenWidthDp</code></td>
</tr>
<tr>
<td><code>Qualifiers#getOrientation()</code></td>
<td><code>Configuration#orientation</code></td>
</tr>
<tr>
<td><code>Qualifiers#getPlatformVersion()</code></td>
<td><code>Build.VERSION#SDK_INT</code></td>
</tr>
<tr>
<td><code>Qualifiers#getScreenWidth()</code></td>
<td><code>Configuration#screenWidthDp</code></td>
</tr>
<tr>
<td><code>Qualifiers#getSmallestScreenWidth()</code></td>
<td><code>Configuration#smallestScreenWidthDp</code></td>
</tr>
<tr>
<td><code>RoboSettings</code></td>
<td>Read/write the <code>robolectric.scheduling.global</code> system property</td>
</tr>
<tr>
<td><code>Scheduler#idleConstantly()</code></td>
<td><code>Scheduler#setIdleState()</code></td>
</tr>
<tr>
<td><code>SdkPicker</code></td>
<td><code>DefaultSdkPicker</code></td>
</tr>
<tr>
<td><code>Shadow#directlyOn(T, Class&lt;T&gt;)</code></td>
<td>Use a combination of <code>Reflector</code> and <code>Direct</code></td>
</tr>
<tr>
<td><code>ShadowApplication#addWakeLock()</code></td>
<td>Use the <code>PowerManager</code> APIs</td>
</tr>
<tr>
<td><code>ShadowApplication#clearWakeLocks()</code></td>
<td><code>ShadowPowerManager#clearWakeLocks()</code></td>
</tr>
<tr>
<td><code>ShadowApplication#getAppWidgetManager()</code></td>
<td><code>Context#getSystemService(Context.APPWIDGET_SERVICE)</code></td>
</tr>
<tr>
<td><code>ShadowApplication#getBluetoothAdapter()</code></td>
<td><code>BluetoothAdapter#getDefaultAdapter()</code></td>
</tr>
<tr>
<td><code>ShadowApplication#getForegroundThreadScheduler()</code></td>
<td>Use the <code>PAUSED</code> looper mode (which is the default)</td>
</tr>
<tr>
<td><code>ShadowApplication#getInstance()</code></td>
<td><code>ApplicationProvider#getApplicationContext()</code></td>
</tr>
<tr>
<td><code>ShadowApplication#getLatestWakeLock()</code></td>
<td><code>ShadowPowerManager#getLatestWakeLock()</code></td>
</tr>
<tr>
<td><code>ShadowApplication#getSingleton()</code></td>
<td>N/A</td>
</tr>
<tr>
<td><code>ShadowAssetInputStream#getDelegate()</code></td>
<td>N/A</td>
</tr>
<tr>
<td><code>ShadowImpl#directlyOn(T, Class&lt;T&gt;)</code></td>
<td>Use a combination of <code>Reflector</code> and <code>Direct</code></td>
</tr>
<tr>
<td><code>ShadowMap#convertToShadowName()</code></td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h3 id="other-changes">Other Changes</h3>
<ul>
<li><code>TestLifecycle</code> no longer has a generic type.</li>
<li>Renamed <code>ActivityData#isClearTaskOnLaungh()</code> into <code>ActivityData#isClearTaskOnLaunch()</code>.</li>
<li>Renamed <code>ResourceIds#makeIdentifer()</code> into <code>ResourceIds#makeIdentifier()</code>.</li>
</ul>
<h2 id="migrating-to-414">Migrating to 4.14</h2>
<h3 id="deprecations_2">Deprecations</h3>
<table>
<thead>
<tr>
<th>Deprecated symbol</th>
<th>Replacement</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org.robolectric:shadows-multidex</code></td>
<td>No longer needed with min SDK being 21+</td>
</tr>
<tr>
<td><code>Implements#looseSignatures()</code></td>
<td>Use either <code>@ClassName</code> or <code>@Implementation(methodName)</code></td>
</tr>
<tr>
<td><code>Supercedes</code></td>
<td><code>Supersedes</code></td>
</tr>
</tbody>
</table>
<h3 id="removals_2">Removals</h3>
<table>
<thead>
<tr>
<th>Removed symbol</th>
<th>Replacement</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>FragmentTestUtil</code></td>
<td>See <a href="https://developer.android.com/guide/fragments/test">Test your fragments</a></td>
</tr>
</tbody>
</table>
<h2 id="migrating-to-413">Migrating to 4.13</h2>
<h3 id="breaking-changes_1">Breaking Changes</h3>
<ul>
<li>This release bumps the min SDK version from 19 to 21, following the move made by the AndroidX
  ecosystem.</li>
</ul>
<h3 id="deprecations_3">Deprecations</h3>
<table>
<thead>
<tr>
<th>Deprecated symbol</th>
<th>Replacement</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Scheduler</code></td>
<td>Use <code>LooperMode.Mode.PAUSED</code> and <code>ShadowLooper</code>'s APIs</td>
</tr>
</tbody>
</table>
<h3 id="removals_3">Removals</h3>
<table>
<thead>
<tr>
<th>Removed symbol</th>
<th>Replacement</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Qualifiers#addPlatformVersion()</code></td>
<td>N/A</td>
</tr>
<tr>
<td><code>RuntimeEnvironment#useLegacyResources()</code></td>
<td>N/A (it always returned <code>false</code>)</td>
</tr>
</tbody>
</table>
<h2 id="migrating-to-412">Migrating to 4.12</h2>
<h3 id="deprecations_4">Deprecations</h3>
<table>
<thead>
<tr>
<th>Deprecated symbol</th>
<th>Replacement</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>RoboSettings#isUseGlobalScheduler()</code></td>
<td><code>LooperMode.Mode.PAUSED</code></td>
</tr>
<tr>
<td><code>RoboSettings#setUseGlobalScheduler()</code></td>
<td><code>LooperMode.Mode.PAUSED</code></td>
</tr>
</tbody>
</table>
<h3 id="removals_4">Removals</h3>
<table>
<thead>
<tr>
<th>Removed symbol</th>
<th>Replacement</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>RobolectricTestRunner#getConfig()</code></td>
<td><code>Provider&lt;Config&gt;</code></td>
</tr>
<tr>
<td><code>RuntimeEnvironment#setUseLegacyResources()</code></td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h2 id="migrating-to-411">Migrating to 4.11</h2>
<h3 id="breaking-changes_2">Breaking Changes</h3>
<ul>
<li>This release bumps the min SDK version from 16 to 19, following the move made by the AndroidX
  ecosystem.</li>
</ul>
<h3 id="deprecations_5">Deprecations</h3>
<table>
<thead>
<tr>
<th>Deprecated symbol</th>
<th>Replacement</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>BackgroundTestRule</code></td>
<td><code>LooperMode.Mode.INSTRUMENTATION_TEST</code></td>
</tr>
</tbody>
</table>
<h2 id="migrating-to-410">Migrating to 4.10</h2>
<h3 id="removals_5">Removals</h3>
<table>
<thead>
<tr>
<th>Removed symbol</th>
<th>Replacement</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Util#intArrayToList()</code></td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h2 id="migrating-to-49">Migrating to 4.9</h2>
<h3 id="deprecations_6">Deprecations</h3>
<table>
<thead>
<tr>
<th>Deprecated symbol</th>
<th>Replacement</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Util#intArrayToList()</code></td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h3 id="removals_6">Removals</h3>
<table>
<thead>
<tr>
<th>Removed symbol</th>
<th>Replacement</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>org.robolectric:shadows-supportv4</code></td>
<td>See <a href="https://developer.android.com/guide/fragments/test">Test your fragments</a></td>
</tr>
</tbody>
</table>
<!-- markdownlint-disable-next-line MD033 -->
<h2 id="migrating-to-40">Migrating to 4.0<a name="migrating-to-40"></a></h2>
<h3 id="project-configuration">Project Configuration</h3>
<p>Robolectric 4.0 requires Android Gradle Plugin 3.2 or greater.</p>
<p>Update the configuration in your module's <code>build.gradle</code>/<code>build.gradle.kts</code> file:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="project-configuration-groovy" name="__tabbed_1" type="radio" /><input id="project-configuration-kotlin" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="project-configuration-groovy">Groovy</label><label for="project-configuration-kotlin">Kotlin</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-groovy highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">android</span><span class="w"> </span><span class="o">{</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="w">  </span><span class="n">compileSdkVersion</span><span class="w"> </span><span class="mi">28</span><span class="w"> </span><span class="c1">// Or newer</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">  </span><span class="n">testOptions</span><span class="o">.</span><span class="na">unitTests</span><span class="o">.</span><span class="na">includeAndroidResources</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="o">}</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-kotlin highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">android</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">  </span><span class="n">compileSdkVersion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="c1">// Or newer</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">  </span><span class="n">testOptions</span><span class="p">.</span><span class="na">unitTests</span><span class="p">.</span><span class="na">isIncludeAndroidResources</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="p">}</span>
</span></code></pre></div>
</div>
</div>
</div>
<p>Add the following in your <code>gradle.properties</code> file:</p>
<div class="language-properties highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="na">android.enableUnitTestBinaryResources</span><span class="o">=</span><span class="s">true</span>
</span></code></pre></div>
<p>If you have dependencies on <code>com.android.support.test</code>, switch them to <code>androidx.test</code>; see
<a href="https://developer.android.com/jetpack/androidx/migrate">Migrate to AndroidX</a>.</p>
<h3 id="deprecations_7">Deprecations</h3>
<table>
<thead>
<tr>
<th>3.8</th>
<th>4.0</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ShadowApplication.getInstance()</code></td>
<td><a href="../javadoc/latest/org/robolectric/RuntimeEnvironment.html#application"><code>RuntimeEnvironment.application</code></a></td>
</tr>
<tr>
<td><code>ShadowApplication.getLatestAlertDialog()</code></td>
<td><a href="../javadoc/latest/org/robolectric/shadows/ShadowAlertDialog.html#getLatestAlertDialog()"><code>ShadowAlertDialog.getLatestAlertDialog()</code></a></td>
</tr>
<tr>
<td><code>ShadowApplication.getLatestDialog()</code></td>
<td><a href="../javadoc/latest/org/robolectric/shadows/ShadowDialog.html#getLatestDialog()"><code>ShadowDialog.getLatestDialog()</code></a></td>
</tr>
<tr>
<td><code>ShadowApplication.getLatestPopupMenu()</code></td>
<td><a href="../javadoc/latest/org/robolectric/shadows/ShadowPopupMenu.html#getLatestPopupMenu()"><code>ShadowPopupMenu.getLatestPopupMenu()</code></a></td>
</tr>
<tr>
<td><code>ShadowLooper.getShadowMainLooper()</code></td>
<td><a href="../javadoc/latest/org/robolectric/Shadows.html#shadowOf(android.os.Looper)"><code>shadowOf(Looper.getMainLooper())</code></a></td>
</tr>
</tbody>
</table>
<p>The <a href="../automated-migration/">automatic migration tool</a> includes a migration to help with this.</p>
<p>The following attributes of the <a href="../javadoc/latest/org/robolectric/annotation/Config.html"><code>@Config</code></a> annotation are no longer supported when
using binary resources mode:</p>
<ul>
<li><a href="../javadoc/latest/org/robolectric/annotation/Config.html#assetDir()"><code>assetDir</code></a> and <a href="../javadoc/latest/org/robolectric/annotation/Config.html#resourceDir()"><code>resourceDir</code></a>: follow
  the recommended file structure of your build system.</li>
<li><a href="../javadoc/latest/org/robolectric/annotation/Config.html#manifest()"><code>manifest</code></a>: Robolectric always uses the merged manifest generated by
  the Android toolchain. If your test was using a custom manifest you'll need to adapt it to not
  rely on that.</li>
<li><a href="../javadoc/latest/org/robolectric/annotation/Config.html#packageName()"><code>packageName</code></a>: to change your package name, override the
  <code>applicationId</code> in your build system.</li>
</ul>
<h3 id="improper-use-of-shadows">Improper Use of Shadows</h3>
<p>Prior to Robolectric 4.0, it was possible (but ill-advised) to get the shadow for an Android
framework object and invoke framework methods there. This could result in unexpected behavior (e.g.,
code in overridden methods in subclasses wouldn't be called). Shadow implementation methods are now
marked <code>protected</code> to guard against this. Always invoke framework methods directly on the Android
class.</p>
<table>
<thead>
<tr>
<th>3.8</th>
<th>4.0</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>shadowOf(activity).finish();</code></td>
<td><a href="https://developer.android.com/reference/android/app/Activity#finish()"><code>activity.finish()</code></a></td>
</tr>
<tr>
<td><code>ShadowSystemClock.currentTimeMillis();</code></td>
<td><a href="https://developer.android.com/reference/java/lang/System#currentTimeMillis()"><code>System.currentTimeMillis()</code></a></td>
</tr>
</tbody>
</table>
<p>The <a href="../automated-migration/">automatic migration tool</a> will fix most of these for you.</p>
<h3 id="androidxtest"><code>androidx.test</code></h3>
<p>Robolectric 4.0 includes initial support for <a href="https://developer.android.com/reference/androidx/test/package-summary"><code>androidx.test</code> APIs</a>. We strongly
recommend adding the latest version of <code>androidx.test:core</code> as a test dependency and using those
APIs whenever possible rather than using Robolectric-specific APIs.</p>
<table>
<thead>
<tr>
<th>3.8</th>
<th>4.0</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>RuntimeEnvironment.application</code></td>
<td><a href="https://developer.android.com/reference/androidx/test/core/app/ApplicationProvider#getApplicationContext()"><code>ApplicationProvider.getApplicationContext()</code></a></td>
</tr>
<tr>
<td><code>ShadowMotionEvent</code></td>
<td><a href="https://developer.android.com/reference/androidx/test/core/view/MotionEventBuilder"><code>MotionEventBuilder</code></a></td>
</tr>
</tbody>
</table>
<h3 id="troubleshooting">Troubleshooting</h3>
<p>Robolectric 4.0 replaces its old home-grown resource handling code with a direct adaptation of
Android's resource handling code, using the full Android toolchain. This greatly improves fidelity
to the behavior of a real Android device, but if your tests were relying on the quirks of the old
code, you may need to fix your tests.</p>
<p>Some likely issues include:</p>
<div class="admonition quote">
<blockquote>
<p>android.view.InflateException: Binary XML file line #3: Failed to resolve attribute at index
17: TypedValue{t=0x2/d=0x7f01000e a=-1}</p>
</blockquote>
<p>This happens when your <a href="https://developer.android.com/reference/android/app/Activity"><code>Activity</code></a> is using a theme that lacks values
for certain attributes used by layouts. Make sure you've specified an appropriate theme for your
activities in your <code>AndroidManifest</code>.</p>
</div>
<!-- markdownlint-disable-next-line MD053 -->









  




                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      ©2010-2025. All rights reserved.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
    <a href="https://github.com/robolectric/robolectric" target="_blank" rel="noopener" title="GitHub Project" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
    <a href="https://groups.google.com/group/robolectric" target="_blank" rel="noopener" title="robolectric@googlegroups.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M61.4 64C27.5 64 0 91.5 0 125.4c0 .9 0 1.7.1 2.6H0v256c0 35.3 28.7 64 64 64h384c35.3 0 64-28.7 64-64V128h-.1c0-.9.1-1.7.1-2.6 0-33.9-27.5-61.4-61.4-61.4zM464 192.3V384c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192.3l154.8 117.4c31.4 23.9 74.9 23.9 106.4 0zM48 125.4c0-7.4 6-13.4 13.4-13.4h389.2c7.4 0 13.4 6 13.4 13.4 0 4.2-2 8.2-5.3 10.7L280.2 271.5c-14.3 10.8-34.1 10.8-48.4 0L53.3 136.1c-3.3-2.5-5.3-6.5-5.3-10.7"/></svg>
    </a>
  
    
    
    
    
    <a href="https://x.com/robolectric" target="_blank" rel="noopener" title="@Robolectric" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M357.2 48h70.6L273.6 224.2 455 464H313L201.7 318.6 74.5 464H3.8l164.9-188.5L-5.2 48h145.6l100.5 132.9zm-24.8 373.8h39.1L119.1 88h-42z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["content.action.view", "content.code.copy", "content.tabs.link", "content.tooltips", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>